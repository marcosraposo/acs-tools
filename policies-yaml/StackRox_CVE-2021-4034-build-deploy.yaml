kind: SecurityPolicy
apiVersion: config.stackrox.io/v1alpha1
metadata:
  name: "pwnkit-cve-2021-local-privilege-escalation"
spec:
  policyName: 'PwnKit: CVE-2021-4034 - Polkit local privilege escalation vulnerability'
  description: Alert on deployments with images containing the PwnKit vulnerability
    (CVE-2021-4034). This is a local privilege escalation vulnerability impacting
    the pkexec binary.
  rationale: This vulnerability allows an unprivileged local attacker to escalate
    privileges, bypassing any authentication and policies due to incorrect handling
    of the process argument vector.
  remediation: Update the polkit package to 0.112-26.el7_9.1 (for RHEL 7-based container
    images) or polkit-0.115-13.el8_5.1 (for RHEL 8-based container images).
  categories:
  - Vulnerability Management
  - atipe
  disabled: false
  lifecycleStages:
  - BUILD
  - DEPLOY
  eventSource: NOT_APPLICABLE
  exclusions:
  - name: ''
    deployment:
      name: ''
      scope:
        cluster: ''
        namespace: ^kube.*|^openshift.*|^redhat.*|^istio.*|^rhacs-operator.*|^stackrox.*
        label: null
    image: null
    expiration: null
  severity: CRITICAL_SEVERITY
  notifiers:
  - 40c72e28-283a-426a-ba56-e749c0847303
  - d8de3118-6f77-4a09-bed2-f8d86b732fd1
  policySections:
  - sectionName: CVE proibido
    policyGroups:
    - fieldName: CVE
      booleanOperator: OR
      negate: false
      values:
      - value: CVE-2021-4034
  scope:
  - cluster: 1bddd820-f647-466d-8b78-2506ad8140ed
    namespace: ''
    label: null
  mitreAttackVectors: []
  criteriaLocked: true
  mitreVectorsLocked: true
  isDefault: false
